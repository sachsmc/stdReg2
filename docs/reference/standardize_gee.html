<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Regression standardization in conditional generalized estimating equations — standardize_gee • stdReg2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regression standardization in conditional generalized estimating equations — standardize_gee"><meta name="description" content="standardize_gee performs regression standardization in linear and log-linear
fixed effects models, at specified values of the exposure, over the sample
covariate distribution. Let \(Y\), \(X\), and \(Z\) be the outcome,
the exposure, and a vector of covariates, respectively. It is assumed that
data are clustered with a cluster indicator \(i\). standardize_gee uses
fitted fixed effects model, with cluster-specific intercept \(a_i\) (see
details), to estimate the standardized mean
\(\theta(x)=E\{E(Y|i,X=x,Z)\}\), where \(x\) is a specific value of
\(X\), and the outer expectation is over the marginal distribution of
\((a_i,Z)\)."><meta property="og:description" content="standardize_gee performs regression standardization in linear and log-linear
fixed effects models, at specified values of the exposure, over the sample
covariate distribution. Let \(Y\), \(X\), and \(Z\) be the outcome,
the exposure, and a vector of covariates, respectively. It is assumed that
data are clustered with a cluster indicator \(i\). standardize_gee uses
fitted fixed effects model, with cluster-specific intercept \(a_i\) (see
details), to estimate the standardized mean
\(\theta(x)=E\{E(Y|i,X=x,Z)\}\), where \(x\) is a specific value of
\(X\), and the outer expectation is over the marginal distribution of
\((a_i,Z)\)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stdReg2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/custom.html">Implementing custom and new methods for standardization</a></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Estimation of causal effects using stdReg2</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sachsmc/stdReg2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Regression standardization in conditional generalized estimating equations</h1>
      <small class="dont-index">Source: <a href="https://github.com/sachsmc/stdReg2/blob/HEAD/R/gee_methods.R" class="external-link"><code>R/gee_methods.R</code></a></small>
      <div class="d-none name"><code>standardize_gee.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>standardize_gee</code> performs regression standardization in linear and log-linear
fixed effects models, at specified values of the exposure, over the sample
covariate distribution. Let \(Y\), \(X\), and \(Z\) be the outcome,
the exposure, and a vector of covariates, respectively. It is assumed that
data are clustered with a cluster indicator \(i\). <code>standardize_gee</code> uses
fitted fixed effects model, with cluster-specific intercept \(a_i\) (see
<code>details</code>), to estimate the standardized mean
\(\theta(x)=E\{E(Y|i,X=x,Z)\}\), where \(x\) is a specific value of
\(X\), and the outer expectation is over the marginal distribution of
\((a_i,Z)\).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">standardize_gee</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  link <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">values</span>,</span>
<span>  <span class="va">clusterid</span>,</span>
<span>  case_control <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ci_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  ci_type <span class="op">=</span> <span class="st">"plain"</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  reference <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  transforms <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula to be used with <code>"gee"</code> in the <span class="pkg">drgee</span> package.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>The link function to be used with <code>"gee"</code>.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The data.</p></dd>


<dt id="arg-values">values<a class="anchor" aria-label="anchor" href="#arg-values"></a></dt>
<dd><p>A named list or data.frame specifying the variables and values
at which marginal means of the outcome will be estimated.</p></dd>


<dt id="arg-clusterid">clusterid<a class="anchor" aria-label="anchor" href="#arg-clusterid"></a></dt>
<dd><p>An optional string containing the name of a cluster identification variable
when data are clustered.</p></dd>


<dt id="arg-case-control">case_control<a class="anchor" aria-label="anchor" href="#arg-case-control"></a></dt>
<dd><p>Whether the data comes from a case-control study.</p></dd>


<dt id="arg-ci-level">ci_level<a class="anchor" aria-label="anchor" href="#arg-ci-level"></a></dt>
<dd><p>Coverage probability of confidence intervals.</p></dd>


<dt id="arg-ci-type">ci_type<a class="anchor" aria-label="anchor" href="#arg-ci-type"></a></dt>
<dd><p>A string, indicating the type of confidence intervals.
Either "plain", which gives untransformed intervals, or "log", which gives
log-transformed intervals.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>A vector of contrasts in the following format:
If set to <code>"difference"</code> or <code>"ratio"</code>, then \(\psi(x)-\psi(x_0)\)
or \(\psi(x) / \psi(x_0)\) are constructed, where \(x_0\) is a reference
level specified by the <code>reference</code> argument. Has to be <code>NULL</code>
if no references are specified.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>The family argument which is used to fit the glm model for the outcome.</p></dd>


<dt id="arg-reference">reference<a class="anchor" aria-label="anchor" href="#arg-reference"></a></dt>
<dd><p>A vector of reference levels in the following format:
If <code>contrasts</code> is not <code>NULL</code>, the desired reference level(s). This
must be a vector or list the same length as <code>contrasts</code>, and if not named,
it is assumed that the order is as specified in contrasts.</p></dd>


<dt id="arg-transforms">transforms<a class="anchor" aria-label="anchor" href="#arg-transforms"></a></dt>
<dd><p>A vector of transforms in the following format:
If set to <code>"log"</code>, <code>"logit"</code>, or <code>"odds"</code>, the standardized
mean \(\theta(x)\) is transformed into \(\psi(x)=\log\{\theta(x)\}\),
\(\psi(x)=\log[\theta(x)/\{1-\theta(x)\}]\), or
\(\psi(x)=\theta(x)/\{1-\theta(x)\}\), respectively.
If the vector is <code>NULL</code>, then \(\psi(x)=\theta(x)\).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>std_glm</code>.
This is basically a list with components estimates and covariance estimates in <code>res</code>.
Results for transformations, contrasts, references are stored in <code>res_contrasts</code>.
Obtain numeric results in a data frame with the <a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a> function.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>standardize_gee</code> assumes that a fixed effects model
$$\eta\{E(Y|i,X,Z)\}=a_i+h(X,Z;\beta)$$ has been fitted. The link
function \(\eta\) is assumed to be the identity link or the log link. The
conditional generalized estimating equation (CGEE) estimate of \(\beta\)
is used to obtain estimates of the cluster-specific means:
$$\hat{a}_i=\sum_{j=1}^{n_i}r_{ij}/n_i,$$ where
$$r_{ij}=Y_{ij}-h(X_{ij},Z_{ij};\hat{\beta})$$ if \(\eta\) is the
identity link, and $$r_{ij}=Y_{ij}\exp\{-h(X_{ij},Z_{ij};\hat{\beta})\}$$
if \(\eta\) is the log link, and \((X_{ij},Z_{ij})\) is the value of
\((X,Z)\) for subject \(j\) in cluster \(i\), \(j=1,...,n_i\),
\(i=1,...,n\). The CGEE estimate of \(\beta\) and the estimate of
\(a_i\) are used to estimate the mean \(E(Y|i,X=x,Z)\):
$$\hat{E}(Y|i,X=x,Z)=\eta^{-1}\{\hat{a}_i+h(X=x,Z;\hat{\beta})\}.$$ For
each \(x\) in the <code>x</code> argument, these estimates are averaged across
all subjects (i.e. all observed values of \(Z\) and all estimated values
of \(a_i\)) to produce estimates $$\hat{\theta}(x)=\sum_{i=1}^n
\sum_{j=1}^{n_i} \hat{E}(Y|i,X=x,Z_i)/N,$$ where \(N=\sum_{i=1}^n n_i\).
The variance for \(\hat{\theta}(x)\) is obtained by the sandwich formula.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The variance calculation performed by <code>standardize_gee</code> does not condition
on the observed covariates \(\bar{Z}=(Z_{11},...,Z_{nn_i})\). To see how
this matters, note that
$$var\{\hat{\theta}(x)\}=E[var\{\hat{\theta}(x)|\bar{Z}\}]+var[E\{\hat{\theta}(x)|\bar{Z}\}].$$
The usual parameter \(\beta\) in a generalized linear model does not
depend on \(\bar{Z}\). Thus, \(E(\hat{\beta}|\bar{Z})\) is independent
of \(\bar{Z}\) as well (since \(E(\hat{\beta}|\bar{Z})=\beta\)), so that
the term \(var[E\{\hat{\beta}|\bar{Z}\}]\) in the corresponding variance
decomposition for \(var(\hat{\beta})\) becomes equal to 0. However,
\(\theta(x)\) depends on \(\bar{Z}\) through the average over the sample
distribution for \(Z\), and thus the term
\(var[E\{\hat{\theta}(x)|\bar{Z}\}]\) is not 0, unless one conditions on
\(\bar{Z}\).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Goetgeluk S. and Vansteelandt S. (2008). Conditional generalized
estimating equations for the analysis of clustered and longitudinal data.
<em>Biometrics</em> <b>64</b>(3), 772-780.</p>
<p>Martin R.S. (2017). Estimation of average marginal effects in multiplicative
unobserved effects panel models. <em>Economics Letters</em> <b>160</b>, 16-19.</p>
<p>Sjölander A. (2019). Estimation of marginal causal effects in the presence
of confounding by cluster. <em>Biostatistics</em> doi:
10.1093/biostatistics/kxz054</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Arvid Sjölander.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">drgee</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: drgee</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span></span></span>
<span class="r-in"><span><span class="va">ni</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, each <span class="op">=</span> <span class="va">ni</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ai</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">ni</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">ni</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">ni</span>, mean <span class="op">=</span> <span class="va">ai</span> <span class="op">+</span> <span class="va">Z</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">ni</span>, mean <span class="op">=</span> <span class="va">ai</span> <span class="op">+</span> <span class="va">X</span> <span class="op">+</span> <span class="va">Z</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">X</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">Z</span>, <span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit.std</span> <span class="op">&lt;-</span> <span class="fu">standardize_gee</span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="va">Z</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">X</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  link <span class="op">=</span> <span class="st">"identity"</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">dd</span>,</span></span>
<span class="r-in"><span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  clusterid <span class="op">=</span> <span class="st">"id"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit.std</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome formula: Y ~ X + Z + I(X^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x63e94b15ac28&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome family: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome link function: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exposure:  X </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tables: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       X Estimate Std.Error lower.0.95 upper.0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  -3.0  -2.3117    0.1895     -2.683     -1.940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  -2.5  -2.0248    0.1531     -2.325     -1.725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  -2.0  -1.6962    0.1246     -1.940     -1.452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -1.5  -1.3258    0.1045     -1.531     -1.121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  -1.0  -0.9137    0.0930     -1.096     -0.731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  -0.5  -0.4598    0.0894     -0.635     -0.285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   0.0   0.0358    0.0920     -0.144      0.216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   0.5   0.5732    0.0991      0.379      0.767</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   1.0   1.1523    0.1101      0.936      1.368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  1.5   1.7731    0.1249      1.528      2.018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  2.0   2.4357    0.1442      2.153      2.718</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  2.5   3.1401    0.1686      2.810      3.471</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  3.0   3.8862    0.1989      3.496      4.276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit.std</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="standardize_gee-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael C Sachs, Arvid Sjölander, Erin E Gabriel, Johan Sebastian Ohlendorff, Adam Brand.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

